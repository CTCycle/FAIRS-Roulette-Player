# FAIRS: Fabulous Automated Intelligent Roulette System

## 1. Project Overview
FAIRS is a local research web application for roulette training and inference experiments. It combines:
- A FastAPI backend for dataset ingestion, training orchestration, checkpoint management, inference sessions, and persistence.
- A React + Vite frontend for running training workflows, monitoring metrics, managing checkpoints, and stepping through inference sessions.

The application runs locally and stores artifacts in `FAIRS/resources`. It is intended for experimentation and does not guarantee predictive performance.

## 2. Model and Dataset (Optional)
FAIRS uses a Deep Q-Network (DQN) workflow for roulette sequence decision making. Training can use:
- User-provided CSV/XLSX datasets uploaded from the UI.
- Synthetic sequences generated by the app.

Inference sessions consume a trained checkpoint and a selected dataset, then evaluate predictions step by step with tracked capital and reward outcomes.

## 3. Installation

### 3.1 Windows (One Click Setup)
Run `FAIRS/start_on_windows.bat`.

The launcher automatically:
1. Downloads portable Python, `uv`, and Node.js into `FAIRS/resources/runtimes`.
2. Installs backend dependencies from `pyproject.toml`.
3. Installs frontend dependencies and builds the client.
4. Starts backend + frontend and opens the UI URL.

First run performs runtime download/build; next runs reuse local artifacts.

### 3.2 macOS / Linux (Manual Setup)
Prerequisites:
- Python 3.14+
- `uv`
- Node.js 22+

Steps:
1. Clone the repository.
2. Optionally create `FAIRS/settings/.env` (you can start from `FAIRS/resources/templates/.env` and add UI settings if needed).
3. Install backend dependencies:

```bash
uv sync
```

4. Start backend:

```bash
uv run python -m uvicorn FAIRS.server.app:app --host 127.0.0.1 --port 8000
```

5. Start frontend:

```bash
cd FAIRS/client
npm install
npm run build
npm run preview -- --host 127.0.0.1 --port 5173 --strictPort
```

## 4. How to Use

### 4.1 Windows
Run `FAIRS/start_on_windows.bat`. The launcher reads `FAIRS/settings/.env` when present (`FASTAPI_*`, `UI_*`). If no overrides are provided, defaults are backend `127.0.0.1:8000` and UI `127.0.0.1:5173`.
In the current local setup shown by `FAIRS/settings/.env`, UI is `127.0.0.1:8000` and API is `127.0.0.1:5000`.

### 4.2 macOS / Linux
Run backend and frontend separately.

```bash
uv run python -m uvicorn FAIRS.server.app:app --host 127.0.0.1 --port 8000
```

```bash
cd FAIRS/client
npm run preview -- --host 127.0.0.1 --port 5173 --strictPort
```

Typical URLs:
- UI: `http://127.0.0.1:5173`
- API: `http://127.0.0.1:8000`
- API docs: `http://127.0.0.1:8000/docs`

### 4.3 Using the Application
Typical flow:
- Upload or select roulette datasets from the Training workflow.
- Configure and start training from the wizard (including dynamic betting/strategy options when needed).
- Monitor live training metrics (loss, RMSE, reward, capital, strategy, progress) from the dashboard.
- Review checkpoint metadata, resume training, or open evaluation from checkpoint actions.
- In Inference, pick a checkpoint and dataset, start a session, submit observed outcomes, apply suggested bets, and inspect session history.

**Training page**
![training_page](assets/figures/training_page.png)

**Inference page**
![inference_page](assets/figures/inference_page.png)

## 5. Setup and Maintenance
- `FAIRS/setup_and_maintenance.bat` -> `Remove logs`: deletes `.log` files in `FAIRS/resources/logs`.
- `FAIRS/setup_and_maintenance.bat` -> `Uninstall app`: removes local runtime/dependency artifacts (`resources/runtimes`, `.venv`, frontend build and node modules, cache files).
- `FAIRS/setup_and_maintenance.bat` -> `Initialize database`: runs `FAIRS/scripts/initialize_database.py`.
- `tests/run_tests.bat`: starts backend + static frontend test server, runs pytest/Playwright tests, then stops started services.

## 6. Resources
`FAIRS/resources` contains local runtime and data assets:
- `checkpoints`: trained model artifacts used for inference and resume flows.
- `database`: embedded SQLite database and related files.
- `logs`: runtime logs.
- `runtimes`: portable Python/uv/Node.js downloaded by the Windows launcher.
- `templates`: starter files (including `.env` template).

## 7. Configuration
Runtime configuration is loaded from `FAIRS/settings/.env` and `FAIRS/settings/configurations.json`.

| Variable | Description |
|----------|-------------|
| `FASTAPI_HOST` | Backend bind host (`FAIRS/settings/.env`, default `127.0.0.1`). |
| `FASTAPI_PORT` | Backend bind port (`FAIRS/settings/.env`, default `8000`). |
| `UI_HOST` | Frontend bind host for Vite preview/dev (`FAIRS/settings/.env`, default `127.0.0.1`). |
| `UI_PORT` | Frontend bind port for Vite preview/dev (`FAIRS/settings/.env`, default `5173`). |
| `RELOAD` | Enables uvicorn reload in launcher (`FAIRS/settings/.env`, default `false`). |
| `VITE_API_BASE_URL` | Frontend API prefix proxied to backend (`FAIRS/settings/.env`, default `/api`). |
| `OPTIONAL_DEPENDENCIES` | Installs optional/test extras in Windows launcher when `true` (`FAIRS/settings/.env`). |
| `MPLBACKEND` | Matplotlib backend for headless execution (`FAIRS/settings/.env`, commonly `Agg`). |
| `KERAS_BACKEND` | Keras backend selection (`FAIRS/settings/.env`, currently `torch`). |
| `database.embedded_database` | Use embedded SQLite when `true`, else external DB settings are used (`FAIRS/settings/configurations.json`). |
| `database.engine` | Database engine preference for non-embedded mode (`FAIRS/settings/configurations.json`). |
| `jobs.polling_interval` | Training polling interval (seconds) returned by `/training/status` (`FAIRS/settings/configurations.json`). |

## 8. License
This project is licensed under the MIT License. See `LICENSE` for details.
